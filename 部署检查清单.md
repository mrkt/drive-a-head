# 🚀 部署检查清单

## ✅ 部署前检查

### 1. 部署包完整性
- [x] 服务器可执行文件：`server/game-server` (6.9MB)
- [x] 启动脚本：`server/start.sh`
- [x] 停止脚本：`server/stop.sh`
- [x] WebGL 客户端：`Builds/WebGL/` (11MB)
- [x] 部署文档：`README.md`
- [x] 快速指南：`QUICKSTART.txt`

**总大小：约 18MB**

### 2. 云服务器要求
- [ ] Linux 系统（Ubuntu 20.04+ / CentOS 7+）
- [ ] 至少 1GB 内存
- [ ] 至少 100MB 磁盘空间
- [ ] 有公网 IP 地址

---

## 📋 部署步骤

### 步骤 1：上传文件
```bash
# 方式1：使用 scp
scp -r deployment root@你的服务器IP:/opt/car-game

# 方式2：使用 rsync
rsync -avz deployment root@你的服务器IP:/opt/car-game

# 方式3：使用 FTP/SFTP 工具（如 FileZilla）
```
- [ ] 文件上传完成

### 步骤 2：登录服务器
```bash
ssh root@你的服务器IP
```
- [ ] 成功登录服务器

### 步骤 3：设置权限
```bash
cd /opt/car-game/deployment/server
chmod +x game-server start.sh stop.sh
```
- [ ] 权限设置完成

### 步骤 4：启动服务器
```bash
./start.sh
```
- [ ] 服务器启动成功
- [ ] 看到启动成功消息

### 步骤 5：配置防火墙

**云服务器控制台（推荐）：**
1. 登录云服务器控制台（阿里云/腾讯云/AWS等）
2. 找到"安全组"或"防火墙"设置
3. 添加入站规则：
   - 协议：TCP
   - 端口：8899
   - 来源：0.0.0.0/0（允许所有IP访问）

**或使用命令行：**
```bash
# firewalld (CentOS 7+)
firewall-cmd --permanent --add-port=8899/tcp
firewall-cmd --reload

# iptables (旧版本)
iptables -A INPUT -p tcp --dport 8899 -j ACCEPT
service iptables save

# ufw (Ubuntu)
ufw allow 8899/tcp
```
- [ ] 端口 8899 已开放

### 步骤 6：验证部署
```bash
# 检查服务器进程
ps aux | grep game-server

# 检查端口监听
netstat -tlnp | grep 8899
# 或
ss -tlnp | grep 8899

# 查看日志
tail -f server.log
```
- [ ] 服务器进程运行中
- [ ] 端口 8899 正在监听
- [ ] 日志无错误信息

### 步骤 7：测试访问
在浏览器中访问：
```
http://你的服务器公网IP:8899
```
- [ ] 能够访问游戏页面
- [ ] WebGL 加载成功
- [ ] 能够进入游戏

---

## 🎮 多人测试

### 测试步骤：
1. [ ] 玩家1访问游戏并进入
2. [ ] 玩家2访问游戏并进入
3. [ ] 两个玩家能看到对方的车辆
4. [ ] 车辆移动同步正常
5. [ ] 碰撞检测正常
6. [ ] 爆炸和重生正常

---

## 🔧 常用命令

### 查看服务器状态
```bash
ps aux | grep game-server
```

### 查看实时日志
```bash
cd /opt/car-game/deployment/server
tail -f server.log
```

### 停止服务器
```bash
cd /opt/car-game/deployment/server
./stop.sh
```

### 重启服务器
```bash
cd /opt/car-game/deployment/server
./stop.sh
sleep 2
./start.sh
```

### 查看端口占用
```bash
netstat -tlnp | grep 8899
# 或
lsof -i :8899
```

---

## ⚠️ 故障排查

### 问题：无法访问游戏

**检查清单：**
1. [ ] 服务器是否启动：`ps aux | grep game-server`
2. [ ] 端口是否监听：`netstat -tlnp | grep 8899`
3. [ ] 防火墙是否开放：检查云服务器安全组
4. [ ] 服务器日志：`tail -100 server.log`
5. [ ] 浏览器控制台：按 F12 查看错误

### 问题：服务器启动失败

**检查清单：**
1. [ ] 查看错误日志：`cat server.log`
2. [ ] 端口是否被占用：`lsof -i :8899`
3. [ ] 文件权限：`ls -l game-server`
4. [ ] 目录结构：确认 `../Builds/WebGL` 存在

### 问题：游戏连接不上

**检查清单：**
1. [ ] WebSocket 连接：浏览器控制台查看 ws:// 连接
2. [ ] 服务器日志：查看是否有连接记录
3. [ ] 网络延迟：`ping 你的服务器IP`
4. [ ] 浏览器兼容性：使用 Chrome/Firefox 测试

---

## 📊 性能监控

### 查看服务器资源使用
```bash
# CPU 和内存
top -p $(pgrep game-server)

# 详细信息
htop
```

### 查看网络连接
```bash
# 查看当前连接数
netstat -an | grep :8899 | wc -l

# 查看连接详情
netstat -an | grep :8899
```

---

## 🎉 部署完成！

当所有检查项都完成后，你的游戏服务器就成功部署了！

**分享给朋友：**
```
http://你的服务器IP:8899
```

**游戏控制：**
- WASD 或 方向键：移动
- 目标：撞击对手的头部让其爆炸

**祝游戏愉快！🎮**
